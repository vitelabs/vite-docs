(window.webpackJsonp=window.webpackJsonp||[]).push([[120],{726:function(e,a,t){"use strict";t.r(a);var c=t(1),i=Object(c.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"migrating-from-solidity-0-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#migrating-from-solidity-0-4"}},[e._v("#")]),e._v(" Migrating from Solidity++ 0.4")]),e._v(" "),t("p",[e._v("Solidity++ 0.8 is syntactically closer to Solidity than Solidity++ 0.4, which is more friendly to developers from Solidity.")]),e._v(" "),t("p",[e._v("Some counter-intuitive syntax and keywords are removed in this version.")]),e._v(" "),t("h2",{attrs:{id:"solidity-0-8-0-changes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solidity-0-8-0-changes"}},[e._v("#")]),e._v(" Solidity++ 0.8.0 Changes")]),e._v(" "),t("h3",{attrs:{id:"breaking-changes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#breaking-changes"}},[e._v("#")]),e._v(" Breaking Changes")]),e._v(" "),t("ul",[t("li",[e._v("All Solidity breaking changes since v0.4.3 to v0.8.0 are applied to Solidity++ 0.8.0.")]),e._v(" "),t("li",[e._v("Most of Solidity contracts and libraries can be compiled by solppc 0.8.0 and imported by Solidity++ 0.8.0 contracts, except for the contracts with external / delegate calls.")]),e._v(" "),t("li",[t("code",[e._v("onMessage")]),e._v(" keyword is deprecated since 0.8.0. Use function declarations instead.")]),e._v(" "),t("li",[t("code",[e._v("message")]),e._v(" keyword is deprecated since 0.8.0. Use "),t("code",[e._v("function")]),e._v(" declared in a "),t("code",[e._v("contract")]),e._v(" or "),t("code",[e._v("interface")]),e._v(" instead.")]),e._v(" "),t("li",[t("code",[e._v("send")]),e._v(" keyword is deprecated since 0.8.0. Use function calls instead.")]),e._v(" "),t("li",[t("code",[e._v("getter")]),e._v(" keyword is deprecated since 0.8.0. Use "),t("code",[e._v("view")]),e._v("/"),t("code",[e._v("pure")]),e._v(" functions instead.")]),e._v(" "),t("li",[e._v("Inline assembly and Yul are available since 0.8.0.")]),e._v(" "),t("li",[t("code",[e._v("keccak256")]),e._v(" is available since 0.8.0.")]),e._v(" "),t("li",[t("code",[e._v("tokenId")]),e._v(" keyword (Vite Native Token Id type) is changed to "),t("code",[e._v("vitetoken")]),e._v(".")]),e._v(" "),t("li",[e._v("Some transaction properties are changed since 0.8.0: "),t("code",[e._v("msg.tokenid")]),e._v(" is changed to "),t("code",[e._v("msg.token")]),e._v(", "),t("code",[e._v("msg.amount")]),e._v(" is changed to "),t("code",[e._v("msg.value")]),e._v(".")])]),e._v(" "),t("h3",{attrs:{id:"compatibilities"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#compatibilities"}},[e._v("#")]),e._v(" Compatibilities")]),e._v(" "),t("ul",[t("li",[e._v("An external or public "),t("code",[e._v("function")]),e._v(" (without return values) in 0.8.0 equivalents to "),t("code",[e._v("onMessage")]),e._v(" in 0.4.3. They have the same signature and selector. For example "),t("code",[e._v("function set(uint data) external")]),e._v(" equivalents to "),t("code",[e._v("onMessage set(uint data)")]),e._v(".")]),e._v(" "),t("li",[e._v("An external or public "),t("code",[e._v("function")]),e._v(" declaration in 0.8.0 equivalents to "),t("code",[e._v("message")]),e._v(" declaration in 0.4.3.")]),e._v(" "),t("li",[e._v("A contract compiled by solppc 0.8.0 can call contracts compiled by solppc 0.4.3 asynchronously.")]),e._v(" "),t("li",[e._v("A contract compiled by solppc 0.4.3 can call contracts compiled by solppc 0.8.0 asynchronously.")]),e._v(" "),t("li",[e._v("The ABI encoding, storage layout, memory layout and calldata layout remain unchanged.")])]),e._v(" "),t("h2",{attrs:{id:"solidity-0-8-1-changes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solidity-0-8-1-changes"}},[e._v("#")]),e._v(" Solidity++ 0.8.1 Changes")]),e._v(" "),t("h3",{attrs:{id:"breaking-changes-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#breaking-changes-2"}},[e._v("#")]),e._v(" Breaking Changes")]),e._v(" "),t("ul",[t("li",[e._v("Solidity contracts and libraries with external / delegate calls can be compiled by solppc 0.8.1 and imported by Solidity++ 0.8.1 contracts.")]),e._v(" "),t("li",[t("code",[e._v("await")]),e._v(" operator is introduced since 0.8.1.")]),e._v(" "),t("li",[e._v("Error propagation through "),t("code",[e._v("revert")]),e._v(" and "),t("code",[e._v("try/catch")]),e._v(" is enabled since 0.8.1.")]),e._v(" "),t("li",[e._v("Delegate calls are allowed since 0.8.1.")]),e._v(" "),t("li",[e._v("External / delegate calls in Solidity are allowed since 0.8.1.")]),e._v(" "),t("li",[e._v("Library linking and calls to external library functions are allowed since 0.8.1.")])]),e._v(" "),t("h3",{attrs:{id:"compatibilities-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#compatibilities-2"}},[e._v("#")]),e._v(" Compatibilities")]),e._v(" "),t("ul",[t("li",[e._v("A contract compiled by solppc 0.8.1 can call contracts compiled by solppc 0.4.3 asynchronously.")]),e._v(" "),t("li",[e._v("A contract compiled by solppc 0.8.1 can call contracts compiled by solppc 0.8.0 both synchronously and asynchronously.")]),e._v(" "),t("li",[e._v("A contract compiled by solppc 0.8.1 can get return values after a synchronous call to a contract compiled by solppc 0.8.0.")]),e._v(" "),t("li",[e._v("The ABI encoding, storage layout, memory layout and calldata layout remain unchanged.")])]),e._v(" "),t("h2",{attrs:{id:"migrate-to-0-8-0"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#migrate-to-0-8-0"}},[e._v("#")]),e._v(" Migrate to 0.8.0")]),e._v(" "),t("p",[e._v("Let's start with an example:")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"javascript",base64:"cHJhZ21hIHNvbGlkaXR5cHAgXjAuNC4zOwoKY29udHJhY3QgQSB7CiAgICBtZXNzYWdlIHN1bSh1aW50IHJlc3VsdCk7CiAgICAKICAgIG9uTWVzc2FnZSBhZGQodWludCBhLCB1aW50IGIpIHsKICAgICAgICB1aW50IHJlc3VsdCA9IGEgKyBiOwogICAgICAgIGFkZHJlc3Mgc2VuZGVyID0gbXNnLnNlbmRlcjsKICAgICAgICBzZW5kKHNlbmRlciwgc3VtKHJlc3VsdCkpOwogICB9Cn0KCmNvbnRyYWN0IEIgewogICAgYWRkcmVzcyBhZGRyQTsKICAgIHVpbnQgdG90YWw7CiAgICBtZXNzYWdlIGFkZCh1aW50IGEsIHVpbnQgYik7CgogICAgY29uc3RydWN0b3IgKGFkZHJlc3MgYWRkcikgewogICAgICAgIGFkZHJBID0gYWRkcjsKICAgIH0KCiAgICBvbk1lc3NhZ2UgaW52b2tlKHVpbnQgYSwgdWludCBiKSB7CiAgICAgICAgc2VuZChhZGRyQSwgYWRkKGEsIGIpKTsKICAgIH0KCiAgICBvbk1lc3NhZ2Ugc3VtKHVpbnQgcmVzdWx0KSB7CiAgICAgICAgdG90YWwgKz0gcmVzdWx0OwogICAgfQoKICAgIGdldHRlciB0b3RhbCgpIHJldHVybnModWludCkgewogICAgICAgIHJldHVybiB0b3RhbDsKICAgIH0KCiAgICBnZXR0ZXIgZ2V0U29tZXRoaW5nKCkgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmV0dXJuIHRvdGFsICsgMTsKICAgIH0KfQo="}}),e._v(" "),t("p",[e._v("In above code, contract A declares a message listener "),t("code",[e._v("add(uint a, uint b)")]),e._v(".")]),e._v(" "),t("p",[e._v("contract B declares "),t("code",[e._v("add")]),e._v(" message which has the same signature to "),t("code",[e._v("add")]),e._v(" message listener in contract A.")]),e._v(" "),t("p",[e._v("Contract B declares a message listener "),t("code",[e._v("invoke")]),e._v(" as the entry to the contract. When "),t("code",[e._v("B.invoke()")]),e._v(" is called, contract B sends a "),t("code",[e._v("add")]),e._v(" message to contract A to initiate an asynchronous message call.")]),e._v(" "),t("p",[e._v("When contract A responds to the message call, it sends a "),t("code",[e._v("sum")]),e._v(" message back to contract B to return data asynchronously.")]),e._v(" "),t("p",[e._v("Contract B also declares a message listener "),t("code",[e._v("sum(uint result)")]),e._v(" as a "),t("em",[e._v("'callback function'")]),e._v(" to handle the returned message from contract A.")]),e._v(" "),t("p",[e._v("Since 0.8.0, "),t("code",[e._v("onMessage")]),e._v(" and "),t("code",[e._v("message")]),e._v(" are replaced with "),t("code",[e._v("function")]),e._v(" and "),t("code",[e._v("send")]),e._v(" statements are replaced with function calls. The "),t("code",[e._v("await")]),e._v(" operator is not allowed in 0.8.0, it is required to declare callbacks explicitly using "),t("code",[e._v("function")]),e._v(".")]),e._v(" "),t("p",[e._v("The migrated code in 0.8.0 is as follows:")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"javascript",base64:"Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0zLjAKcHJhZ21hIHNvbGlkaXR5cHAgXjAuOC4wOwoKaW50ZXJmYWNlIExpc3RlbmVyIHsKICAgIC8vIGRlbGFyZSBhIGNhbGxiYWNrIHRvIHJlY2VpdmUgdGhlIHJlc3VsdAogICAgZnVuY3Rpb24gc3VtKHVpbnQgcmVzdWx0KSBleHRlcm5hbDsKfQoKY29udHJhY3QgQSB7CiAgICAvLyB0aGUgb25NZXNzYWdlIGlzIHJlcGxhY2VkIHdpdGggYW4gZXh0ZXJuYWwgZnVuY3Rpb24KICAgIGZ1bmN0aW9uIGFkZCh1aW50IGEsIHVpbnQgYikgZXh0ZXJuYWwgewogICAgICAgIExpc3RlbmVyIHNlbmRlciA9IExpc3RlbmVyKG1zZy5zZW5kZXIpOwogICAgICAgIC8vIHNlbmQgbWVzc2FnZSB0byB0aGUgY2FsbGVyCiAgICAgICAgc2VuZGVyLnN1bShhICsgYik7CiAgICB9Cn0KCmNvbnRyYWN0IEIgaXMgTGlzdGVuZXIgewogICAgQSBjb250cmFjdEE7CiAgICB1aW50IHB1YmxpYyB0b3RhbDsgIC8vIGEgZ2V0dGVyIGZ1bmN0aW9uIHdpbGwgYmUgYXV0by1nZW5lcmF0ZWQgYnkgdGhlIGNvbXBpbGVyCgogICAgY29uc3RydWN0b3IgKGFkZHJlc3MgYWRkcikgewogICAgICAgIGNvbnRyYWN0QSA9IEEoYWRkcik7CiAgICB9CgogICAgLy8gdGhlIG9uTWVzc2FnZSBpcyByZXBsYWNlZCB3aXRoIGEgZnVuY3Rpb24KICAgIGZ1bmN0aW9uIGludm9rZSh1aW50IGEsIHVpbnQgYikgZXh0ZXJuYWwgewogICAgICAgIC8vIHJlcGxhY2UgdGhlIHNlbmQgc3RhdGVtZW50IHdpdGggYSBmdW5jdGlvbiBjYWxsCiAgICAgICAgY29udHJhY3RBLmFkZChhLCBiKTsKICAgIH0KICAgIC8vIHRoZSBjYWxsYmFjayBpcyByZXBsYWNlZCB3aXRoIGEgZnVuY3Rpb24KICAgIGZ1bmN0aW9uIHN1bSh1aW50IHJlc3VsdCkgZXh0ZXJuYWwgb3ZlcnJpZGUgewogICAgICAgIHRvdGFsICs9IHJlc3VsdDsKICAgIH0KICAgIC8vIHRoZSBvZmZjaGFpbiBnZXR0ZXIgaXMgcmVwbGFjZWQgd2l0aCBhIHZpZXcgb3IgcHVyZSBmdW5jdGlvbgogICAgZnVuY3Rpb24gZ2V0U29tZXRoaW5nKCkgZXh0ZXJuYWwgdmlldyByZXR1cm5zKHVpbnQpIHsKICAgICAgICByZXR1cm4gdG90YWwgKyAxOwogICAgfQp9Cg=="}}),e._v(" "),t("h2",{attrs:{id:"migrate-to-0-8-1"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#migrate-to-0-8-1"}},[e._v("#")]),e._v(" Migrate to 0.8.1")]),e._v(" "),t("p",[e._v("Since Solidity++ 0.8.1, no explicit callback declarations are required.")]),e._v(" "),t("p",[e._v("The compiler is smart enough to generate callbacks automatically. The code is simplified and optimized significantly by "),t("code",[e._v("await")]),e._v(" syntactic sugar.")]),e._v(" "),t("p",[e._v("The migrated code in 0.8.1 is as follows:")]),e._v(" "),t("tm-code-block",{staticClass:"codeblock",attrs:{language:"javascript",base64:"Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0zLjAKcHJhZ21hIHNvbGlkaXR5cHAgXjAuOC4xOwoKY29udHJhY3QgQSB7CiAgICAvLyB0aGUgYXN5bmMgZnVuY3Rpb24gY2FuIHJldHVybiBkYXRhIHRvIHRoZSBjYWxsZXIKICAgIGZ1bmN0aW9uIGFkZCh1aW50IGEsIHVpbnQgYikgZXh0ZXJuYWwgYXN5bmMgcmV0dXJucyh1aW50KSB7CiAgICAgICAgcmV0dXJuIGEgKyBiOwogICAgfQp9Cgpjb250cmFjdCBCIHsKICAgIEEgY29udHJhY3RBOwogICAgdWludCBwdWJsaWMgdG90YWw7CgogICAgY29uc3RydWN0b3IgKGFkZHJlc3MgYWRkcikgewogICAgICAgIGNvbnRyYWN0QSA9IEEoYWRkcik7CiAgICB9CgogICAgZnVuY3Rpb24gaW52b2tlKHVpbnQgYSwgdWludCBiKSBleHRlcm5hbCBhc3luYyB7CiAgICAgICAgLy8gdXNlIGF3YWl0IGV4cHJlc3Npb24gdG8gZ2V0IGRhdGEgcmV0dXJuZWQgZnJvbSB0aGUgY2FsbGVkIGNvbnRyYWN0CiAgICAgICAgdG90YWwgKz0gYXdhaXQgY29udHJhY3RBLmFkZChhLCBiKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRTb21ldGhpbmcoKSBleHRlcm5hbCB2aWV3IHJldHVybnModWludCkgewogICAgICAgIHJldHVybiB0b3RhbCArIDE7CiAgICB9Cn0K"}})],1)}),[],!1,null,null,null);a.default=i.exports}}]);